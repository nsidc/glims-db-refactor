#!/usr/bin/env python

'''
Input line looks something like this:


INSERT INTO data.glacier_entities (analysis_id, line_type, entity_geom) VALUES (715234, 'glac_bound', ST_GeomFromEWKT('SRID=4326;POLYGON ((-19.044715 63.583785, -19.044762 63.583877, -19.044899 63.583991, -19.045111 63.584099, -19.045404 63.584206, -19.045759 63.58431, -19.046159 63.584412, -19.046937 63.584595, -19.047301 63.58467, -19.047845 63.584752, -19.048387 63.584801, -19.04892 63.58483, -19.049472 63.58485, -19.050607 63.584878, -19.052921 63.584915, -19.054065 63.584939, -19.054625 63.584956, -19.055172 63.584978, -19.055702 63.585007, -19.056208 63.585047, -19.056682 63.5851, -19.057112 63.585172, -19.057381 63.585233, -19.057893 63.585367, -19.058636 63.585579, -19.058987 63.585664, -19.060001 63.585878, -19.060286 63.585933, -19.060744 63.585998, -19.061243 63.586046, -19.061771 63.586082, -19.062321 63.586108, -19.062886 63.586128, -19.064047 63.586156, -19.067589 63.586218, -19.06874 63.586251, -19.069299 63.586274, -19.069841 63.586304, -19.070359 63.586342, -19.070848 63.586392, -19.071473 63.586471, -19.071938 63.586516, -19.072424 63.586547, -19.072923 63.586566, -19.073426 63.586573, -19.073926 63.586568, -19.074415 63.586551, -19.074886 63.58652, -19.075519 63.586457, -19.076005 63.586421, -19.076519 63.586396, -19.077051 63.586379, -19.077597 63.586367, -19.079259 63.586343, -19.079807 63.586332, -19.080342 63.586315, -19.080858 63.586289, -19.08135 63.586252, -19.081992 63.586184, -19.082439 63.586148, -19.082905 63.586121, -19.083384 63.586101, -19.084839 63.586048, -19.085312 63.586024, -19.085766 63.585993, -19.086196 63.585949, -19.086796 63.585862, -19.087897 63.585716, -19.08825 63.585661, -19.088581 63.585596, -19.088836 63.585531, -19.089323 63.585391, -19.089561 63.585318, -19.090013 63.585162, -19.090938 63.584859, -19.091268 63.584769, -19.091942 63.584594, -19.092417 63.584448, -19.093147 63.584238, -19.093396 63.584171, -19.093752 63.584092, -19.094785 63.583902, -19.095074 63.583854, -19.095543 63.583798, -19.096048 63.583759, -19.096575 63.583731, -19.097652 63.583685, -19.098179 63.583657, -19.098683 63.583617, -19.099148 63.583559, -19.099429 63.583507, -19.099712 63.583444, -19.100015 63.583371, -19.100329 63.583289, -19.101799 63.582855, -19.10216 63.582733, -19.102385 63.582643, -19.102722 63.582488, -19.102824 63.582429, -19.102875 63.582384, -19.102873 63.58236, -19.10283 63.582356, -19.102731 63.582333, -19.102392 63.582239, -19.102057 63.582159, -19.10082 63.581903, -19.100438 63.581832, -19.099823 63.581744, -19.099188 63.581681, -19.098571 63.58164, -19.097994 63.581618, -19.096246 63.581568, -19.095672 63.581547, -19.095112 63.581521, -19.094573 63.581485, -19.094065 63.581437, -19.0936 63.581371, -19.093316 63.581315, -19.092318 63.581095, -19.091982 63.581004, -19.09175 63.580926, -19.091094 63.580679, -19.090286 63.58032, -19.089901 63.580133, -19.089506 63.579951, -19.089125 63.579762, -19.08873 63.579579, -19.088347 63.579391, -19.087556 63.579025, -19.086734 63.578673, -19.086074 63.578427, -19.085846 63.578348, -19.085519 63.578253, -19.084848 63.57807, -19.084065 63.577818, -19.083758 63.577714, -19.083483 63.577597, -19.083255 63.57746, -19.083062 63.577309, -19.082758 63.577029, -19.082644 63.576903, -19.082523 63.576705, -19.082445 63.576488, -19.082397 63.576259, -19.082372 63.576021, -19.082361 63.575777, -19.082365 63.574779, -19.082356 63.574533, -19.082334 63.574293, -19.082294 63.574061, -19.082228 63.57384, -19.082127 63.573633, -19.081934 63.573366, -19.081564 63.572824, -19.081367 63.572558, -19.081264 63.572357, -19.081191 63.572144, -19.081139 63.571921, -19.081031 63.571234, -19.080984 63.57101, -19.080919 63.570794, -19.080823 63.57059, -19.080685 63.570403, -19.080556 63.570283, -19.080261 63.570058, -19.0801 63.569952, -19.079924 63.569851, -19.079377 63.569558, -19.078603 63.569186, -19.078202 63.569005, -19.077812 63.56882, -19.07741 63.568641, -19.077021 63.568455, -19.076621 63.568274, -19.075849 63.567901, -19.075115 63.567512, -19.074946 63.567409, -19.074622 63.567196, -19.074471 63.567085, -19.074314 63.566942, -19.073903 63.566487, -19.073746 63.566343, -19.073595 63.566232, -19.073273 63.566019, -19.073104 63.565915, -19.072924 63.565817, -19.072374 63.565525, -19.071606 63.56515, -19.07121 63.564967, -19.070826 63.56478, -19.070427 63.564599, -19.070041 63.564412, -19.069641 63.564232, -19.069254 63.564045, -19.068854 63.563865, -19.068467 63.563679, -19.068066 63.563498, -19.067679 63.563312, -19.067278 63.563132, -19.066891 63.562946, -19.066491 63.562765, -19.065717 63.562393, -19.064981 63.562004, -19.064813 63.561901, -19.064494 63.561686, -19.064348 63.561573, -19.064167 63.561387, -19.064018 63.561188, -19.063739 63.560783, -19.063534 63.56052, -19.063423 63.560334, -19.063333 63.56014, -19.063092 63.559544, -19.06299 63.559354, -19.062809 63.559082, -19.062708 63.558892, -19.062624 63.558695, -19.062397 63.558093, -19.062301 63.5579, -19.062137 63.557621, -19.062046 63.557398, -19.061986 63.557161, -19.061951 63.556915, -19.061933 63.556661, -19.061928 63.556402, -19.061942 63.555873, -19.061994 63.555067, -19.062188 63.552633, -19.062222 63.552095, -19.06224 63.551565, -19.062238 63.551305, -19.062222 63.55105, -19.062189 63.550803, -19.062129 63.550566, -19.062032 63.550345, -19.061851 63.550073, -19.061577 63.549625, -19.061402 63.549368, -19.061336 63.549288, -19.060997 63.549422, -19.060334 63.549584, -19.060093 63.549691, -19.059671 63.54988, -19.05949 63.54988, -19.05943 63.549719, -19.059188 63.549692, -19.059128 63.549638, -19.058826 63.549531, -19.058645 63.549396, -19.058585 63.549262, -19.057861 63.549181, -19.057801 63.549181, -19.05762 63.549074, -19.057318 63.54894, -19.056835 63.54894, -19.056594 63.549021, -19.056354 63.549155, -19.05569 63.549128, -19.054665 63.549048, -19.054424 63.548995, -19.054062 63.548941, -19.05364 63.549049, -19.053158 63.54921, -19.0534 63.549398, -19.053521 63.54964, -19.053521 63.549855, -19.053401 63.550044, -19.05322 63.550151, -19.0531 63.550259, -19.05304 63.55042, -19.0531 63.550555, -19.05292 63.550743, -19.052619 63.551012, -19.052318 63.551201, -19.052257 63.551281, -19.052017 63.551443, -19.051896 63.551685, -19.051957 63.551873, -19.051535 63.551954, -19.051173 63.551766, -19.050992 63.551551, -19.05081 63.551336, -19.05081 63.551174, -19.051111 63.550986, -19.051111 63.550824, -19.051111 63.550609, -19.05105 63.550475, -19.050989 63.550287, -19.050808 63.550152, -19.050446 63.549991, -19.050326 63.54991, -19.050084 63.549749, -19.050084 63.549695, -19.049963 63.549615, -19.049722 63.549453, -19.049661 63.549292, -19.049661 63.549104, -19.0496 63.548969, -19.049479 63.548808, -19.048936 63.548432, -19.048695 63.548271, -19.048333 63.548029, -19.048272 63.547921, -19.04797 63.547706, -19.047668 63.547518, -19.047608 63.547437, -19.047487 63.547303, -19.047246 63.547115, -19.047004 63.5469, -19.046883 63.546738, -19.046461 63.546631, -19.04634 63.546523, -19.046159 63.546416, -19.046159 63.546422, -19.046099 63.546328, -19.045978 63.546207, -19.045978 63.546073, -19.045586 63.545952, -19.045224 63.545858, -19.044772 63.545791, -19.044259 63.545737, -19.044018 63.545603, -19.043656 63.545536, -19.043264 63.545536, -19.042903 63.545536, -19.042692 63.545509, -19.042239 63.545429, -19.041908 63.545415, -19.041516 63.545335, -19.041305 63.545268, -19.041093 63.545106, -19.040912 63.544891, -19.040852 63.544811, -19.04061 63.544636, -19.040339 63.544327, -19.040278 63.544165, -19.040097 63.544017, -19.039826 63.543897, -19.039795 63.543776, -19.039976 63.543641, -19.040187 63.543399, -19.040337 63.54313, -19.040427 63.542915, -19.040487 63.54274, -19.040457 63.542552, -19.040396 63.542337, -19.040396 63.542175, -19.040305 63.542014, -19.040214 63.541758, -19.040305 63.541651, -19.040576 63.541557, -19.040666 63.541395, -19.040877 63.541261, -19.041148 63.541113, -19.041268 63.540884, -19.04178 63.540696, -19.042232 63.540534, -19.042563 63.540373, -19.042894 63.540104, -19.043406 63.539821, -19.043768 63.539619, -19.044189 63.539471, -19.044551 63.53927, -19.044882 63.539027, -19.045273 63.538853, -19.045213 63.538678, -19.045604 63.538449, -19.045694 63.538315, -19.046026 63.538247, -19.046297 63.53818, -19.046477 63.538005, -19.046628 63.537803, -19.047019 63.537601, -19.047109 63.537467, -19.047139 63.537447, -19.04726 63.53742, -19.04735 63.537339, -19.04741 63.537218, -19.04741 63.537151, -19.04753 63.53703, -19.047681 63.536882, -19.047711 63.536761, -19.04774 63.536573, -19.0478 63.536398, -19.0478 63.536129, -19.0478 63.535941, -19.047679 63.53582, -19.047709 63.535672, -19.047829 63.535618, -19.04816 63.535456, -19.048341 63.535268, -19.048642 63.535107, -19.048581 63.534986, -19.04828 63.534811, -19.048069 63.534784, -19.047466 63.534663, -19.047225 63.534623, -19.046833 63.534475, -19.046411 63.534408, -19.04617 63.534395, -19.045778 63.534395, -19.045326 63.534382, -19.044995 63.534288, -19.044904 63.53418, -19.044693 63.534005, -19.044391 63.533858, -19.04403 63.53371, -19.043728 63.533508, -19.044029 63.533387, -19.04427 63.533226, -19.044119 63.533024, -19.043998 63.532836, -19.043907 63.532661, -19.043666 63.532392, -19.043515 63.532164, -19.043153 63.531895, -19.04243 63.531693, -19.041947 63.531559, -19.041315 63.531452, -19.040591 63.531277, -19.039748 63.53125, -19.038994 63.531304, -19.038543 63.531479, -19.03785 63.531547, -19.037368 63.531681, -19.037097 63.531802, -19.036856 63.531883, -19.036284 63.532018, -19.036073 63.532125, -19.035802 63.532314, -19.035501 63.532368, -19.035079 63.532462, -19.034838 63.53261, -19.034567 63.532785, -19.034297 63.533054, -19.034206 63.533242, -19.033996 63.53347, -19.033845 63.533672, -19.033665 63.53378, -19.033303 63.533928, -19.033123 63.534116, -19.033153 63.534304, -19.033063 63.534506, -19.033003 63.534667, -19.032913 63.534775, -19.032732 63.534963, -19.032552 63.535125, -19.032281 63.535313, -19.032281 63.535447, -19.031949 63.535622, -19.031769 63.53577, -19.031377 63.535865, -19.031287 63.535999, -19.031136 63.53616, -19.030986 63.536268, -19.030926 63.536456, -19.030655 63.536685, -19.030625 63.53686, -19.030505 63.537129, -19.030354 63.537303, -19.030294 63.537411, -19.030234 63.537519, -19.030083 63.537626, -19.030084 63.537747, -19.030054 63.537882, -19.029963 63.53803, -19.029873 63.538124, -19.029873 63.538151, -19.029873 63.538258, -19.029723 63.538379, -19.029512 63.538447, -19.029361 63.53842, -19.02924 63.538326, -19.028999 63.538245, -19.028788 63.538164, -19.028698 63.538016, -19.028788 63.537895, -19.028818 63.537801, -19.028757 63.537653, -19.028516 63.537559, -19.028185 63.537519, -19.028185 63.537398, -19.028185 63.537237, -19.028215 63.537143, -19.028245 63.537048, -19.028034 63.536901, -19.027973 63.536726, -19.027883 63.536645, -19.027641 63.53647, -19.02746 63.536296, -19.02743 63.536161, -19.02734 63.535959, -19.027279 63.535798, -19.026827 63.535475, -19.026616 63.535301, -19.026194 63.535126, -19.025922 63.534965, -19.025621 63.534696, -19.02547 63.534521, -19.025018 63.534333, -19.024475 63.534145, -19.024053 63.533983, -19.023421 63.533903, -19.023119 63.533768, -19.022697 63.533661, -19.022396 63.533674, -19.022095 63.533849, -19.021914 63.533984, -19.021884 63.534186, -19.021824 63.534508, -19.021463 63.534616, -19.021433 63.534804, -19.021614 63.535073, -19.021674 63.535355, -19.021704 63.535544, -19.021735 63.535786, -19.021765 63.536014, -19.021916 63.536216, -19.022157 63.536391, -19.022278 63.536525, -19.022368 63.536686, -19.022429 63.536928, -19.022399 63.53717, -19.022429 63.537372, -19.022429 63.537574, -19.02252 63.537762, -19.02252 63.537991, -19.02252 63.538152, -19.022611 63.538421, -19.022671 63.538529, -19.022671 63.538744, -19.022822 63.538972, -19.023003 63.539107, -19.023124 63.539228, -19.023184 63.539335, -19.023395 63.539577, -19.023486 63.539806, -19.023335 63.53994, -19.023276 63.539983, -19.023215 63.539987, -19.022974 63.53996, -19.022763 63.539907, -19.022341 63.539853, -19.022009 63.539853, -19.021738 63.539934, -19.021648 63.540082, -19.021648 63.540189, -19.021557 63.540431, -19.021859 63.540512, -19.02213 63.540579, -19.022371 63.540781, -19.022733 63.540902, -19.023155 63.541238, -19.023276 63.54144, -19.023306 63.541682, -19.023487 63.54191, -19.023759 63.542179, -19.024091 63.542515, -19.024242 63.542663, -19.024181 63.542636, -19.024483 63.542838, -19.024634 63.542972, -19.024604 63.543201, -19.024724 63.543389, -19.024936 63.543604, -19.025147 63.543765, -19.025267 63.543927, -19.025298 63.543967, -19.025418 63.544142, -19.025509 63.54429, -19.02566 63.544384, -19.02578 63.544451, -19.025961 63.544478, -19.026293 63.544532, -19.026564 63.544599, -19.027107 63.544706, -19.027439 63.544868, -19.027559 63.545002, -19.027921 63.545163, -19.028102 63.545204, -19.028464 63.545325, -19.028645 63.545446, -19.028916 63.545472, -19.028946 63.545593, -19.028947 63.545714, -19.028796 63.545795, -19.029037 63.545956, -19.029309 63.546064, -19.02955 63.546171, -19.02961 63.54636, -19.029671 63.546481, -19.029647 63.546491, -19.029701 63.546635, -19.030123 63.546823, -19.030606 63.547092, -19.031209 63.547361, -19.031933 63.547603, -19.032476 63.547737, -19.033018 63.547925, -19.033682 63.548087, -19.034345 63.548409, -19.034707 63.548597, -19.035431 63.548785, -19.036095 63.548947, -19.036999 63.549215, -19.037241 63.549538, -19.037422 63.54978, -19.037965 63.549887, -19.038447 63.549968, -19.03887 63.550371, -19.039051 63.550694, -19.039594 63.550963, -19.040017 63.551151, -19.040258 63.5515, -19.039716 63.551662, -19.039234 63.551958, -19.039174 63.552415, -19.039235 63.552711, -19.038874 63.552953, -19.038994 63.553168, -19.039176 63.553329, -19.039176 63.553491, -19.039297 63.553786, -19.039538 63.554028, -19.039539 63.55427, -19.039418 63.554405, -19.039358 63.554593, -19.039539 63.554754, -19.039419 63.554943, -19.039359 63.555077, -19.0396 63.555265, -19.039782 63.5554, -19.039782 63.555642, -19.039722 63.55583, -19.039602 63.556018, -19.03936 63.556099, -19.0393 63.556234, -19.039301 63.556422, -19.039301 63.556556, -19.03906 63.556691, -19.038999 63.556745, -19.038939 63.556503, -19.038878 63.55618, -19.038817 63.555992, -19.038817 63.555777, -19.038696 63.555561, -19.038455 63.555373, -19.038334 63.555158, -19.038153 63.554997, -19.037972 63.55497, -19.037791 63.554997, -19.037127 63.554836, -19.037067 63.554674, -19.037368 63.55454, -19.03785 63.554459, -19.037971 63.554378, -19.03779 63.554136, -19.037609 63.553921, -19.037427 63.553733, -19.037065 63.553357, -19.036944 63.553061, -19.036944 63.552711, -19.036883 63.552442, -19.037003 63.552173, -19.037063 63.551905, -19.037183 63.551716, -19.036701 63.551582, -19.036037 63.551448, -19.035434 63.551313, -19.034891 63.551206, -19.034107 63.550991, -19.033866 63.550749, -19.033685 63.550453, -19.033383 63.550399, -19.03278 63.5504, -19.032418 63.5504, -19.031936 63.5504, -19.031514 63.550239, -19.031755 63.549943, -19.031513 63.549728, -19.031272 63.549566, -19.030548 63.549351, -19.030488 63.549136, -19.030367 63.548813, -19.029944 63.548518, -19.029522 63.548222, -19.029401 63.547953, -19.028979 63.547684, -19.028195 63.547442, -19.027772 63.547281, -19.026989 63.547174, -19.026084 63.546986, -19.025481 63.546986, -19.02518 63.54704, -19.024517 63.547228, -19.024336 63.547497, -19.024276 63.547712, -19.024276 63.547981, -19.024397 63.548277, -19.024819 63.548626, -19.025242 63.548841, -19.025604 63.54903, -19.025664 63.549218, -19.025302 63.549433, -19.024881 63.549568, -19.025001 63.549245, -19.02488 63.54911, -19.02476 63.54911, -19.024157 63.549299, -19.023795 63.549353, -19.023373 63.549164, -19.023131 63.548922, -19.02277 63.548761, -19.022347 63.548681, -19.021925 63.548627, -19.021503 63.548546, -19.021202 63.548439, -19.0209 63.548277, -19.02084 63.548224, -19.020659 63.548224, -19.020357 63.548197, -19.020056 63.54817, -19.019935 63.548089, -19.019996 63.547955, -19.020116 63.547874, -19.020056 63.547578, -19.019995 63.547363, -19.019754 63.547148, -19.019392 63.54704, -19.018548 63.547041, -19.018005 63.547094, -19.017463 63.547148, -19.017041 63.547417, -19.016619 63.547525, -19.016438 63.547767, -19.016438 63.547955, -19.016499 63.548305, -19.016137 63.548466, -19.015896 63.548628, -19.015233 63.54895, -19.014811 63.54895, -19.01463 63.548735, -19.014931 63.548413, -19.014931 63.548063, -19.015052 63.547767, -19.014931 63.547579, -19.014448 63.547229, -19.013785 63.547149, -19.013303 63.547176, -19.0127 63.547364, -19.012399 63.547633, -19.012399 63.547902, -19.012761 63.548251, -19.013123 63.548574, -19.013123 63.54887, -19.012882 63.549031, -19.01258 63.549112, -19.01258 63.549246, -19.012761 63.549488, -19.01246 63.549731, -19.011917 63.549811, -19.011616 63.549892, -19.011495 63.550134, -19.011676 63.550403, -19.011676 63.550591, -19.011315 63.550726, -19.010772 63.550726, -19.01041 63.550564, -19.009988 63.550484, -19.009385 63.550296, -19.009144 63.550027, -19.008842 63.549892, -19.00848 63.549704, -19.007998 63.549596, -19.007636 63.549489, -19.007214 63.549354, -19.006491 63.549354, -19.00631 63.549596, -19.00631 63.549839, -19.006491 63.550134, -19.006491 63.550403, -19.00637 63.550834, -19.006009 63.550995, -19.005707 63.551129, -19.005225 63.551129, -19.004863 63.550941, -19.004622 63.550807, -19.003898 63.550565, -19.003657 63.550403, -19.003355 63.550134, -19.003262 63.550075, -19.00331 63.550159, -19.003399 63.550267, -19.003527 63.550418, -19.003671 63.55057, -19.003845 63.550717, -19.004 63.550819, -19.004335 63.55102, -19.004511 63.551118, -19.00527 63.551495, -19.005669 63.551677, -19.006058 63.551864, -19.00646 63.552045, -19.007241 63.552416, -19.007428 63.552513, -19.00798 63.552805, -19.008309 63.553016, -19.008467 63.553124, -19.008612 63.553238, -19.00879 63.553424, -19.008935 63.553625, -19.0092 63.554037, -19.009389 63.554306, -19.009485 63.554498, -19.009556 63.554701, -19.009752 63.555548, -19.009819 63.555752, -19.00991 63.555946, -19.010036 63.556125, -19.010156 63.556249, -19.010424 63.556485, -19.010564 63.556601, -19.010858 63.556826, -19.011035 63.556984, -19.011372 63.557307, -19.011642 63.557542, -19.0118 63.557708, -19.012193 63.558182, -19.012293 63.558314, -19.012403 63.558523, -19.012474 63.558749, -19.012516 63.558987, -19.012538 63.559233, -19.012546 63.559485, -19.01253 63.560769, -19.012544 63.561018, -19.012576 63.56126, -19.012633 63.561492, -19.012724 63.561709, -19.012861 63.561907, -19.012986 63.562029, -19.013265 63.56226, -19.013413 63.562372, -19.013729 63.562589, -19.013877 63.562701, -19.014156 63.562932, -19.01428 63.563054, -19.014414 63.563247, -19.014503 63.563458, -19.014561 63.563683, -19.014594 63.563918, -19.014618 63.564405, -19.014628 63.565148, -19.014644 63.56539, -19.014677 63.565625, -19.014734 63.56585, -19.014824 63.566061, -19.014959 63.566253, -19.015086 63.566374, -19.015376 63.566601, -19.015534 63.566709, -19.016226 63.567115, -19.016582 63.567315, -19.017067 63.567634, -19.017215 63.567746, -19.017403 63.567928, -19.017717 63.56832, -19.017886 63.56851, -19.018148 63.568748, -19.018487 63.569071, -19.018674 63.569225, -19.018834 63.569332, -19.019344 63.569641, -19.020089 63.570025, -19.02048 63.57021, -19.020862 63.570398, -19.021259 63.57058, -19.021645 63.570767, -19.022043 63.570948, -19.022429 63.571135, -19.022827 63.571316, -19.023212 63.571503, -19.02361 63.571685, -19.023995 63.571872, -19.024393 63.572054, -19.024777 63.572241, -19.025174 63.572423, -19.025558 63.572611, -19.025955 63.572793, -19.026339 63.57298, -19.026735 63.573162, -19.027119 63.57335, -19.027516 63.573532, -19.027899 63.57372, -19.028296 63.573902, -19.02868 63.57409, -19.029077 63.574272, -19.02946 63.574459, -19.029857 63.574642, -19.03024 63.574829, -19.030637 63.575011, -19.031021 63.575199, -19.031418 63.575381, -19.031801 63.575569, -19.032198 63.575751, -19.032582 63.575939, -19.032978 63.576121, -19.033362 63.576308, -19.033759 63.576491, -19.034143 63.576678, -19.03454 63.57686, -19.034923 63.577048, -19.03532 63.57723, -19.035704 63.577417, -19.036102 63.577599, -19.036486 63.577787, -19.036883 63.577969, -19.037268 63.578156, -19.037666 63.578337, -19.038051 63.578524, -19.03845 63.578706, -19.038835 63.578893, -19.039234 63.579074, -19.03962 63.579261, -19.040018 63.579443, -19.0404 63.579631, -19.040792 63.579815, -19.041348 63.580104, -19.041534 63.580212, -19.041712 63.580341, -19.041881 63.580488, -19.042042 63.580647, -19.042183 63.580819, -19.042327 63.581089, -19.042413 63.581369, -19.042454 63.581641, -19.042463 63.581885, -19.042453 63.582083, -19.042425 63.582267, -19.042857 63.582267, -19.043047 63.582272, -19.043158 63.582287, -19.043202 63.58231, -19.043221 63.582343, -19.043227 63.582422, -19.043181 63.582995, -19.043157 63.58327, -19.043161 63.58331, -19.043188 63.583341, -19.043255 63.583354, -19.043344 63.583359, -19.043962 63.583365, -19.043937 63.58364, -19.043942 63.58368, -19.043969 63.58371, -19.044033 63.583724, -19.044118 63.583728, -19.044743 63.583735, -19.044715 63.583785))'));
'''

import sys
import re


def ring_str_to_coords(ring_str):
    """
    Converts a single ring, in ascii format, to a list of tuples

    Args:
      ring_str: The part of the EWKT string representing a ring.

    Returns:
      List of tuples: the coordinates in floating point.
    """
    # Split coordinates into individual points
    coordinates = [tuple(map(float, point.strip().split(' '))) for point in ring_str.strip('()').split(',')]
    return coordinates


def is_polygon_closed(ewkt_string):
    """
    Checks if a polygon defined in EWKT format is closed.

    Args:
      ewkt_string: The EWKT string representing the polygon.

    Returns:
      True if the polygon is closed (first and last coordinates are the same), 
      False otherwise.
    """

    # Extract coordinates from EWKT string
    #match = re.search(r"POLYGON ?\(\(([\d\.\s,-]+)\)[,)]", ewkt_string) # matches only outer ring
    #print("ewkt_string = ", ewkt_string)
    match = re.search(r"POLYGON ?\(([()\d\.\s,-]+)\)", ewkt_string)  # matches entire polygon, including inner rings
    if not match:
        #print("match:  ", match)
        raise ValueError("Invalid EWKT string format.")

    coordinates_str = match.group(1)

    #print("coordinates_str:  ", coordinates_str)

    # Split coordinates into individual points
    for ring_no, ring in enumerate(re.findall(r'(\([\d\s,.]+\))', coordinates_str)):
        print(f"ring {ring_no} = {ring}")
        coordinates = ring_str_to_coords(ring)
        if coordinates[0] != coordinates[-1]:
            return False

    return True


# Example usage:
#ewkt1 = "SRID=4326;POLYGON ((1 1, 1 2, 2 2, 2 1, 1 1));"  # Closed polygon
#ewkt2 = "SRID=4326;POLYGON ((1 1, 1 2, 2 2, 2 1));"     # Open polygon
#ewkt3 = "SRID=4326;POLYGON ((1 1, 1 2, 2 2, 2 1, 1 1.0000000001));"  # Closed (with slight floating-point difference)
#ewkt4 = "SRID=4326;POLYGON ((1 1, 1 2, 2 2, 2 1, 1 1), (1.5 1.5, 1.5 1.6, 1.6 1.6, 1.6 1.5, 1.5 1.5));"  # Closed polygon with hole
#ewkt5 = "SRID=4326;POLYGON ((1 1, 1 2, 2 2, 2 1, 1 1), (1.5 1.5, 1.5 1.6, 1.6 1.6, 1.6 1.5, 1.5 1.5), (1.1 1.1, 1.2 1.1, 1.2 1.8));"  # Closed polygon with unclosed hole
#ewkt6 = "sdflkerwj sdflkeerwjsd flkerw dflSRID=4326;POLYGON ((-19.044715 63.583785, -19.044762 63.583877, -19.044899 63.583991, -19.045111 63.584099, -19.045404 63.584206, -19.045759 63.58431, -19.046159 63.584412, -19.046937 63.584595, -19.047301 63.58467, -19.047845 63.584752, -19.048387 63.584801, -19.04892 63.58483, -19.049472 63.58485, -19.050607 63.584878, -19.052921 63.584915, -19.054065 63.584939, -19.054625 63.584956, -19.055172 63.584978, -19.055702 63.585007, -19.056208 63.585047, -19.056682 63.5851, -19.057112 63.585172, -19.057381 63.585233, -19.057893 63.585367, -19.058636 63.585579, -19.058987 63.585664, -19.060001 63.585878, -19.060286 63.585933, -19.060744 63.585998, -19.061243 63.586046, -19.061771 63.586082, -19.062321 63.586108, -19.062886 63.586128, -19.064047 63.586156, -19.067589 63.586218, -19.06874 63.586251, -19.069299 63.586274, -19.069841 63.586304, -19.070359 63.586342, -19.070848 63.586392, -19.071473 63.586471, -19.071938 63.586516, -19.072424 63.586547, -19.072923 63.586566, -19.073426 63.586573, -19.073926 63.586568, -19.074415 63.586551, -19.074886 63.58652, -19.075519 63.586457, -19.076005 63.586421, -19.076519 63.586396, -19.077051 63.586379, -19.077597 63.586367, -19.079259 63.586343, -19.079807 63.586332, -19.080342 63.586315, -19.080858 63.586289, -19.08135 63.586252, -19.081992 63.586184, -19.082439 63.586148, -19.082905 63.586121, -19.083384 63.586101, -19.084839 63.586048, -19.085312 63.586024, -19.085766 63.585993, -19.086196 63.585949, -19.086796 63.585862, -19.087897 63.585716, -19.08825 63.585661, -19.088581 63.585596, -19.088836 63.585531, -19.089323 63.585391, -19.089561 63.585318, -19.090013 63.585162, -19.090938 63.584859, -19.091268 63.584769, -19.091942 63.584594, -19.092417 63.584448, -19.093147 63.584238, -19.093396 63.584171, -19.093752 63.584092, -19.094785 63.583902, -19.095074 63.583854, -19.095543 63.583798, -19.096048 63.583759, -19.096575 63.583731, -19.097652 63.583685, -19.098179 63.583657, -19.098683 63.583617, -19.099148 63.583559, -19.099429 63.583507, -19.099712 63.583444, -19.100015 63.583371, -19.100329 63.583289, -19.101799 63.582855, -19.10216 63.582733, -19.102385 63.582643, -19.102722 63.582488, -19.102824 63.582429, -19.102875 63.582384, -19.102873 63.58236, -19.10283 63.582356, -19.102731 63.582333, -19.102392 63.582239, -19.102057 63.582159, -19.10082 63.581903, -19.100438 63.581832, -19.099823 63.581744, -19.099188 63.581681, -19.098571 63.58164, -19.097994 63.581618, -19.096246 63.581568, -19.095672 63.581547, -19.095112 63.581521, -19.094573 63.581485, -19.094065 63.581437, -19.0936 63.581371, -19.093316 63.581315, -19.092318 63.581095, -19.091982 63.581004, -19.09175 63.580926, -19.091094 63.580679, -19.090286 63.58032, -19.089901 63.580133, -19.089506 63.579951, -19.089125 63.579762, -19.08873 63.579579, -19.088347 63.579391, -19.087556 63.579025, -19.086734 63.578673, -19.086074 63.578427, -19.085846 63.578348, -19.085519 63.578253, -19.084848 63.57807, -19.084065 63.577818, -19.083758 63.577714, -19.083483 63.577597, -19.083255 63.57746, -19.083062 63.577309, -19.082758 63.577029, -19.082644 63.576903, -19.082523 63.576705, -19.082445 63.576488, -19.082397 63.576259, -19.082372 63.576021, -19.082361 63.575777, -19.082365 63.574779, -19.082356 63.574533, -19.082334 63.574293, -19.082294 63.574061, -19.082228 63.57384, -19.082127 63.573633, -19.081934 63.573366, -19.081564 63.572824, -19.081367 63.572558, -19.081264 63.572357, -19.081191 63.572144, -19.081139 63.571921, -19.081031 63.571234, -19.080984 63.57101, -19.080919 63.570794, -19.080823 63.57059, -19.080685 63.570403, -19.080556 63.570283, -19.080261 63.570058, -19.0801 63.569952, -19.079924 63.569851, -19.079377 63.569558, -19.078603 63.569186, -19.078202 63.569005, -19.077812 63.56882, -19.07741 63.568641, -19.077021 63.568455, -19.076621 63.568274, -19.075849 63.567901, -19.075115 63.567512, -19.074946 63.567409, -19.074622 63.567196, -19.074471 63.567085, -19.074314 63.566942, -19.073903 63.566487, -19.073746 63.566343, -19.073595 63.566232, -19.073273 63.566019, -19.073104 63.565915, -19.072924 63.565817, -19.072374 63.565525, -19.071606 63.56515, -19.07121 63.564967, -19.070826 63.56478, -19.070427 63.564599, -19.070041 63.564412, -19.069641 63.564232, -19.069254 63.564045, -19.068854 63.563865, -19.068467 63.563679, -19.068066 63.563498, -19.067679 63.563312, -19.067278 63.563132, -19.066891 63.562946, -19.066491 63.562765, -19.065717 63.562393, -19.064981 63.562004, -19.064813 63.561901, -19.064494 63.561686, -19.064348 63.561573, -19.064167 63.561387, -19.064018 63.561188, -19.063739 63.560783, -19.063534 63.56052, -19.063423 63.560334, -19.063333 63.56014, -19.063092 63.559544, -19.06299 63.559354, -19.062809 63.559082, -19.062708 63.558892, -19.062624 63.558695, -19.062397 63.558093, -19.062301 63.5579, -19.062137 63.557621, -19.062046 63.557398, -19.061986 63.557161, -19.061951 63.556915, -19.061933 63.556661, -19.061928 63.556402, -19.061942 63.555873, -19.061994 63.555067, -19.062188 63.552633, -19.062222 63.552095, -19.06224 63.551565, -19.062238 63.551305, -19.062222 63.55105, -19.062189 63.550803, -19.062129 63.550566, -19.062032 63.550345, -19.061851 63.550073, -19.061577 63.549625, -19.061402 63.549368, -19.061336 63.549288, -19.060997 63.549422, -19.060334 63.549584, -19.060093 63.549691, -19.059671 63.54988, -19.05949 63.54988, -19.05943 63.549719, -19.059188 63.549692, -19.059128 63.549638, -19.058826 63.549531, -19.058645 63.549396, -19.058585 63.549262, -19.057861 63.549181, -19.057801 63.549181, -19.05762 63.549074, -19.057318 63.54894, -19.056835 63.54894, -19.056594 63.549021, -19.056354 63.549155, -19.05569 63.549128, -19.054665 63.549048, -19.054424 63.548995, -19.054062 63.548941, -19.05364 63.549049, -19.053158 63.54921, -19.0534 63.549398, -19.053521 63.54964, -19.053521 63.549855, -19.053401 63.550044, -19.05322 63.550151, -19.0531 63.550259, -19.05304 63.55042, -19.0531 63.550555, -19.05292 63.550743, -19.052619 63.551012, -19.052318 63.551201, -19.052257 63.551281, -19.052017 63.551443, -19.051896 63.551685, -19.051957 63.551873, -19.051535 63.551954, -19.051173 63.551766, -19.050992 63.551551, -19.05081 63.551336, -19.05081 63.551174, -19.051111 63.550986, -19.051111 63.550824, -19.051111 63.550609, -19.05105 63.550475, -19.050989 63.550287, -19.050808 63.550152, -19.050446 63.549991, -19.050326 63.54991, -19.050084 63.549749, -19.050084 63.549695, -19.049963 63.549615, -19.049722 63.549453, -19.049661 63.549292, -19.049661 63.549104, -19.0496 63.548969, -19.049479 63.548808, -19.048936 63.548432, -19.048695 63.548271, -19.048333 63.548029, -19.048272 63.547921, -19.04797 63.547706, -19.047668 63.547518, -19.047608 63.547437, -19.047487 63.547303, -19.047246 63.547115, -19.047004 63.5469, -19.046883 63.546738, -19.046461 63.546631, -19.04634 63.546523, -19.046159 63.546416, -19.046159 63.546422, -19.046099 63.546328, -19.045978 63.546207, -19.045978 63.546073, -19.045586 63.545952, -19.045224 63.545858, -19.044772 63.545791, -19.044259 63.545737, -19.044018 63.545603, -19.043656 63.545536, -19.043264 63.545536, -19.042903 63.545536, -19.042692 63.545509, -19.042239 63.545429, -19.041908 63.545415, -19.041516 63.545335, -19.041305 63.545268, -19.041093 63.545106, -19.040912 63.544891, -19.040852 63.544811, -19.04061 63.544636, -19.040339 63.544327, -19.040278 63.544165, -19.040097 63.544017, -19.039826 63.543897, -19.039795 63.543776, -19.039976 63.543641, -19.040187 63.543399, -19.040337 63.54313, -19.040427 63.542915, -19.040487 63.54274, -19.040457 63.542552, -19.040396 63.542337, -19.040396 63.542175, -19.040305 63.542014, -19.040214 63.541758, -19.040305 63.541651, -19.040576 63.541557, -19.040666 63.541395, -19.040877 63.541261, -19.041148 63.541113, -19.041268 63.540884, -19.04178 63.540696, -19.042232 63.540534, -19.042563 63.540373, -19.042894 63.540104, -19.043406 63.539821, -19.043768 63.539619, -19.044189 63.539471, -19.044551 63.53927, -19.044882 63.539027, -19.045273 63.538853, -19.045213 63.538678, -19.045604 63.538449, -19.045694 63.538315, -19.046026 63.538247, -19.046297 63.53818, -19.046477 63.538005, -19.046628 63.537803, -19.047019 63.537601, -19.047109 63.537467, -19.047139 63.537447, -19.04726 63.53742, -19.04735 63.537339, -19.04741 63.537218, -19.04741 63.537151, -19.04753 63.53703, -19.047681 63.536882, -19.047711 63.536761, -19.04774 63.536573, -19.0478 63.536398, -19.0478 63.536129, -19.0478 63.535941, -19.047679 63.53582, -19.047709 63.535672, -19.047829 63.535618, -19.04816 63.535456, -19.048341 63.535268, -19.048642 63.535107, -19.048581 63.534986, -19.04828 63.534811, -19.048069 63.534784, -19.047466 63.534663, -19.047225 63.534623, -19.046833 63.534475, -19.046411 63.534408, -19.04617 63.534395, -19.045778 63.534395, -19.045326 63.534382, -19.044995 63.534288, -19.044904 63.53418, -19.044693 63.534005, -19.044391 63.533858, -19.04403 63.53371, -19.043728 63.533508, -19.044029 63.533387, -19.04427 63.533226, -19.044119 63.533024, -19.043998 63.532836, -19.043907 63.532661, -19.043666 63.532392, -19.043515 63.532164, -19.043153 63.531895, -19.04243 63.531693, -19.041947 63.531559, -19.041315 63.531452, -19.040591 63.531277, -19.039748 63.53125, -19.038994 63.531304, -19.038543 63.531479, -19.03785 63.531547, -19.037368 63.531681, -19.037097 63.531802, -19.036856 63.531883, -19.036284 63.532018, -19.036073 63.532125, -19.035802 63.532314, -19.035501 63.532368, -19.035079 63.532462, -19.034838 63.53261, -19.034567 63.532785, -19.034297 63.533054, -19.034206 63.533242, -19.033996 63.53347, -19.033845 63.533672, -19.033665 63.53378, -19.033303 63.533928, -19.033123 63.534116, -19.033153 63.534304, -19.033063 63.534506, -19.033003 63.534667, -19.032913 63.534775, -19.032732 63.534963, -19.032552 63.535125, -19.032281 63.535313, -19.032281 63.535447, -19.031949 63.535622, -19.031769 63.53577, -19.031377 63.535865, -19.031287 63.535999, -19.031136 63.53616, -19.030986 63.536268, -19.030926 63.536456, -19.030655 63.536685, -19.030625 63.53686, -19.030505 63.537129, -19.030354 63.537303, -19.030294 63.537411, -19.030234 63.537519, -19.030083 63.537626, -19.030084 63.537747, -19.030054 63.537882, -19.029963 63.53803, -19.029873 63.538124, -19.029873 63.538151, -19.029873 63.538258, -19.029723 63.538379, -19.029512 63.538447, -19.029361 63.53842, -19.02924 63.538326, -19.028999 63.538245, -19.028788 63.538164, -19.028698 63.538016, -19.028788 63.537895, -19.028818 63.537801, -19.028757 63.537653, -19.028516 63.537559, -19.028185 63.537519, -19.028185 63.537398, -19.028185 63.537237, -19.028215 63.537143, -19.028245 63.537048, -19.028034 63.536901, -19.027973 63.536726, -19.027883 63.536645, -19.027641 63.53647, -19.02746 63.536296, -19.02743 63.536161, -19.02734 63.535959, -19.027279 63.535798, -19.026827 63.535475, -19.026616 63.535301, -19.026194 63.535126, -19.025922 63.534965, -19.025621 63.534696, -19.02547 63.534521, -19.025018 63.534333, -19.024475 63.534145, -19.024053 63.533983, -19.023421 63.533903, -19.023119 63.533768, -19.022697 63.533661, -19.022396 63.533674, -19.022095 63.533849, -19.021914 63.533984, -19.021884 63.534186, -19.021824 63.534508, -19.021463 63.534616, -19.021433 63.534804, -19.021614 63.535073, -19.021674 63.535355, -19.021704 63.535544, -19.021735 63.535786, -19.021765 63.536014, -19.021916 63.536216, -19.022157 63.536391, -19.022278 63.536525, -19.022368 63.536686, -19.022429 63.536928, -19.022399 63.53717, -19.022429 63.537372, -19.022429 63.537574, -19.02252 63.537762, -19.02252 63.537991, -19.02252 63.538152, -19.022611 63.538421, -19.022671 63.538529, -19.022671 63.538744, -19.022822 63.538972, -19.023003 63.539107, -19.023124 63.539228, -19.023184 63.539335, -19.023395 63.539577, -19.023486 63.539806, -19.023335 63.53994, -19.023276 63.539983, -19.023215 63.539987, -19.022974 63.53996, -19.022763 63.539907, -19.022341 63.539853, -19.022009 63.539853, -19.021738 63.539934, -19.021648 63.540082, -19.021648 63.540189, -19.021557 63.540431, -19.021859 63.540512, -19.02213 63.540579, -19.022371 63.540781, -19.022733 63.540902, -19.023155 63.541238, -19.023276 63.54144, -19.023306 63.541682, -19.023487 63.54191, -19.023759 63.542179, -19.024091 63.542515, -19.024242 63.542663, -19.024181 63.542636, -19.024483 63.542838, -19.024634 63.542972, -19.024604 63.543201, -19.024724 63.543389, -19.024936 63.543604, -19.025147 63.543765, -19.025267 63.543927, -19.025298 63.543967, -19.025418 63.544142, -19.025509 63.54429, -19.02566 63.544384, -19.02578 63.544451, -19.025961 63.544478, -19.026293 63.544532, -19.026564 63.544599, -19.027107 63.544706, -19.027439 63.544868, -19.027559 63.545002, -19.027921 63.545163, -19.028102 63.545204, -19.028464 63.545325, -19.028645 63.545446, -19.028916 63.545472, -19.028946 63.545593, -19.028947 63.545714, -19.028796 63.545795, -19.029037 63.545956, -19.029309 63.546064, -19.02955 63.546171, -19.02961 63.54636, -19.029671 63.546481, -19.029647 63.546491, -19.029701 63.546635, -19.030123 63.546823, -19.030606 63.547092, -19.031209 63.547361, -19.031933 63.547603, -19.032476 63.547737, -19.033018 63.547925, -19.033682 63.548087, -19.034345 63.548409, -19.034707 63.548597, -19.035431 63.548785, -19.036095 63.548947, -19.036999 63.549215, -19.037241 63.549538, -19.037422 63.54978, -19.037965 63.549887, -19.038447 63.549968, -19.03887 63.550371, -19.039051 63.550694, -19.039594 63.550963, -19.040017 63.551151, -19.040258 63.5515, -19.039716 63.551662, -19.039234 63.551958, -19.039174 63.552415, -19.039235 63.552711, -19.038874 63.552953, -19.038994 63.553168, -19.039176 63.553329, -19.039176 63.553491, -19.039297 63.553786, -19.039538 63.554028, -19.039539 63.55427, -19.039418 63.554405, -19.039358 63.554593, -19.039539 63.554754, -19.039419 63.554943, -19.039359 63.555077, -19.0396 63.555265, -19.039782 63.5554, -19.039782 63.555642, -19.039722 63.55583, -19.039602 63.556018, -19.03936 63.556099, -19.0393 63.556234, -19.039301 63.556422, -19.039301 63.556556, -19.03906 63.556691, -19.038999 63.556745, -19.038939 63.556503, -19.038878 63.55618, -19.038817 63.555992, -19.038817 63.555777, -19.038696 63.555561, -19.038455 63.555373, -19.038334 63.555158, -19.038153 63.554997, -19.037972 63.55497, -19.037791 63.554997, -19.037127 63.554836, -19.037067 63.554674, -19.037368 63.55454, -19.03785 63.554459, -19.037971 63.554378, -19.03779 63.554136, -19.037609 63.553921, -19.037427 63.553733, -19.037065 63.553357, -19.036944 63.553061, -19.036944 63.552711, -19.036883 63.552442, -19.037003 63.552173, -19.037063 63.551905, -19.037183 63.551716, -19.036701 63.551582, -19.036037 63.551448, -19.035434 63.551313, -19.034891 63.551206, -19.034107 63.550991, -19.033866 63.550749, -19.033685 63.550453, -19.033383 63.550399, -19.03278 63.5504, -19.032418 63.5504, -19.031936 63.5504, -19.031514 63.550239, -19.031755 63.549943, -19.031513 63.549728, -19.031272 63.549566, -19.030548 63.549351, -19.030488 63.549136, -19.030367 63.548813, -19.029944 63.548518, -19.029522 63.548222, -19.029401 63.547953, -19.028979 63.547684, -19.028195 63.547442, -19.027772 63.547281, -19.026989 63.547174, -19.026084 63.546986, -19.025481 63.546986, -19.02518 63.54704, -19.024517 63.547228, -19.024336 63.547497, -19.024276 63.547712, -19.024276 63.547981, -19.024397 63.548277, -19.024819 63.548626, -19.025242 63.548841, -19.025604 63.54903, -19.025664 63.549218, -19.025302 63.549433, -19.024881 63.549568, -19.025001 63.549245, -19.02488 63.54911, -19.02476 63.54911, -19.024157 63.549299, -19.023795 63.549353, -19.023373 63.549164, -19.023131 63.548922, -19.02277 63.548761, -19.022347 63.548681, -19.021925 63.548627, -19.021503 63.548546, -19.021202 63.548439, -19.0209 63.548277, -19.02084 63.548224, -19.020659 63.548224, -19.020357 63.548197, -19.020056 63.54817, -19.019935 63.548089, -19.019996 63.547955, -19.020116 63.547874, -19.020056 63.547578, -19.019995 63.547363, -19.019754 63.547148, -19.019392 63.54704, -19.018548 63.547041, -19.018005 63.547094, -19.017463 63.547148, -19.017041 63.547417, -19.016619 63.547525, -19.016438 63.547767, -19.016438 63.547955, -19.016499 63.548305, -19.016137 63.548466, -19.015896 63.548628, -19.015233 63.54895, -19.014811 63.54895, -19.01463 63.548735, -19.014931 63.548413, -19.014931 63.548063, -19.015052 63.547767, -19.014931 63.547579, -19.014448 63.547229, -19.013785 63.547149, -19.013303 63.547176, -19.0127 63.547364, -19.012399 63.547633, -19.012399 63.547902, -19.012761 63.548251, -19.013123 63.548574, -19.013123 63.54887, -19.012882 63.549031, -19.01258 63.549112, -19.01258 63.549246, -19.012761 63.549488, -19.01246 63.549731, -19.011917 63.549811, -19.011616 63.549892, -19.011495 63.550134, -19.011676 63.550403, -19.011676 63.550591, -19.011315 63.550726, -19.010772 63.550726, -19.01041 63.550564, -19.009988 63.550484, -19.009385 63.550296, -19.009144 63.550027, -19.008842 63.549892, -19.00848 63.549704, -19.007998 63.549596, -19.007636 63.549489, -19.007214 63.549354, -19.006491 63.549354, -19.00631 63.549596, -19.00631 63.549839, -19.006491 63.550134, -19.006491 63.550403, -19.00637 63.550834, -19.006009 63.550995, -19.005707 63.551129, -19.005225 63.551129, -19.004863 63.550941, -19.004622 63.550807, -19.003898 63.550565, -19.003657 63.550403, -19.003355 63.550134, -19.003262 63.550075, -19.00331 63.550159, -19.003399 63.550267, -19.003527 63.550418, -19.003671 63.55057, -19.003845 63.550717, -19.004 63.550819, -19.004335 63.55102, -19.004511 63.551118, -19.00527 63.551495, -19.005669 63.551677, -19.006058 63.551864, -19.00646 63.552045, -19.007241 63.552416, -19.007428 63.552513, -19.00798 63.552805, -19.008309 63.553016, -19.008467 63.553124, -19.008612 63.553238, -19.00879 63.553424, -19.008935 63.553625, -19.0092 63.554037, -19.009389 63.554306, -19.009485 63.554498, -19.009556 63.554701, -19.009752 63.555548, -19.009819 63.555752, -19.00991 63.555946, -19.010036 63.556125, -19.010156 63.556249, -19.010424 63.556485, -19.010564 63.556601, -19.010858 63.556826, -19.011035 63.556984, -19.011372 63.557307, -19.011642 63.557542, -19.0118 63.557708, -19.012193 63.558182, -19.012293 63.558314, -19.012403 63.558523, -19.012474 63.558749, -19.012516 63.558987, -19.012538 63.559233, -19.012546 63.559485, -19.01253 63.560769, -19.012544 63.561018, -19.012576 63.56126, -19.012633 63.561492, -19.012724 63.561709, -19.012861 63.561907, -19.012986 63.562029, -19.013265 63.56226, -19.013413 63.562372, -19.013729 63.562589, -19.013877 63.562701, -19.014156 63.562932, -19.01428 63.563054, -19.014414 63.563247, -19.014503 63.563458, -19.014561 63.563683, -19.014594 63.563918, -19.014618 63.564405, -19.014628 63.565148, -19.014644 63.56539, -19.014677 63.565625, -19.014734 63.56585, -19.014824 63.566061, -19.014959 63.566253, -19.015086 63.566374, -19.015376 63.566601, -19.015534 63.566709, -19.016226 63.567115, -19.016582 63.567315, -19.017067 63.567634, -19.017215 63.567746, -19.017403 63.567928, -19.017717 63.56832, -19.017886 63.56851, -19.018148 63.568748, -19.018487 63.569071, -19.018674 63.569225, -19.018834 63.569332, -19.019344 63.569641, -19.020089 63.570025, -19.02048 63.57021, -19.020862 63.570398, -19.021259 63.57058, -19.021645 63.570767, -19.022043 63.570948, -19.022429 63.571135, -19.022827 63.571316, -19.023212 63.571503, -19.02361 63.571685, -19.023995 63.571872, -19.024393 63.572054, -19.024777 63.572241, -19.025174 63.572423, -19.025558 63.572611, -19.025955 63.572793, -19.026339 63.57298, -19.026735 63.573162, -19.027119 63.57335, -19.027516 63.573532, -19.027899 63.57372, -19.028296 63.573902, -19.02868 63.57409, -19.029077 63.574272, -19.02946 63.574459, -19.029857 63.574642, -19.03024 63.574829, -19.030637 63.575011, -19.031021 63.575199, -19.031418 63.575381, -19.031801 63.575569, -19.032198 63.575751, -19.032582 63.575939, -19.032978 63.576121, -19.033362 63.576308, -19.033759 63.576491, -19.034143 63.576678, -19.03454 63.57686, -19.034923 63.577048, -19.03532 63.57723, -19.035704 63.577417, -19.036102 63.577599, -19.036486 63.577787, -19.036883 63.577969, -19.037268 63.578156, -19.037666 63.578337, -19.038051 63.578524, -19.03845 63.578706, -19.038835 63.578893, -19.039234 63.579074, -19.03962 63.579261, -19.040018 63.579443, -19.0404 63.579631, -19.040792 63.579815, -19.041348 63.580104, -19.041534 63.580212, -19.041712 63.580341, -19.041881 63.580488, -19.042042 63.580647, -19.042183 63.580819, -19.042327 63.581089, -19.042413 63.581369, -19.042454 63.581641, -19.042463 63.581885, -19.042453 63.582083, -19.042425 63.582267, -19.042857 63.582267, -19.043047 63.582272, -19.043158 63.582287, -19.043202 63.58231, -19.043221 63.582343, -19.043227 63.582422, -19.043181 63.582995, -19.043157 63.58327, -19.043161 63.58331, -19.043188 63.583341, -19.043255 63.583354, -19.043344 63.583359, -19.043962 63.583365, -19.043937 63.58364, -19.043942 63.58368, -19.043969 63.58371, -19.044033 63.583724, -19.044118 63.583728, -19.044743 63.583735, -19.044715 63.583785))'));"
#
#print(f"Is ewkt1 closed? {is_polygon_closed(ewkt1)}")  # Output: True
#print(f"Is ewkt2 closed? {is_polygon_closed(ewkt2)}")  # Output: False
#print(f"Is ewkt3 closed? {is_polygon_closed(ewkt3)}")  # Output: True (consider floating-point tolerance)
#print(f"Is ewkt4 closed? {is_polygon_closed(ewkt4)}")  # Output: True (consider floating-point tolerance)
#print(f"Is ewkt5 closed? {is_polygon_closed(ewkt5)}")  # Output: True (consider floating-point tolerance)
#print(f"Is ewkt6 closed? {is_polygon_closed(ewkt6)}")  # Output: True (consider floating-point tolerance)


def main():
    if len(sys.argv) != 2:
        print(f'Usage:  {sys.argv[0]} <sql_filename>')
        sys.exit(1)

    infile = sys.argv[1]
    print(f"Checking for polygon closure in {infile}.")

    with open(infile, 'r') as fh:
        for lineno, line in enumerate(fh):
            if 'INSERT INTO data.glacier_entities' in line:
                print("Line", lineno)
                if not is_polygon_closed(line):
                    print("Found unclosed polygon")


if __name__ == '__main__':
    main()
